"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5cf31a09-18a7-5881-97ad-68b7caa9fba2")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[9246],{900878:(e,t,a)=>{a.d(t,{E:()=>o,P:()=>c});var n=a(574724),l=a(852800);function r(e,t){let a={},n=e.getVariableConsumptionMap();if(Object.keys(n).length>0)for(let[r,o]of Object.entries(n))if((null==o?void 0:o.isMixed)||(null==o?void 0:o.type)!==l.Z_n.ALIAS){if(!(null==o?void 0:o.isMixed)&&(null==o?void 0:o.type)===l.Z_n.EXPRESSION)for(let n of function e(t){let a=[];for(let n of t.value.expressionArguments)n.type===l.Z_n.ALIAS?a.push(n.value):n.type===l.Z_n.EXPRESSION&&a.push(...e(n));return a}(o))i(n,r,e,t,a)}else{let n=null==o?void 0:o.value;a[n]||i(n,r,e,t,a)}for(let n of e.childrenNodes)Object.assign(a,r(n,t));return a}function i(e,t,a,n,l){var r,i,o;if(!l[e]){l[e]={nodesUsed:{}};let t=null==(r=n.get(e))?void 0:r.name;t&&(l[e].name=t);let a=null==(i=n.get(e))?void 0:i.description;a&&(l[e].description=a);let c=null==(o=n.get(e))?void 0:o.resolvedType;c&&(l[e].resolvedType=c)}return l[e].nodesUsed[a.guid]||(l[e].nodesUsed[a.guid]={nodeName:a.name,fields:[]}),l[e].nodesUsed[a.guid].fields.push(t),l}function o(e,t,a=new Map){let n=function(e,t=new Map,a=!1){if(a)return r(e.getRoot(),t);let n=e.getCurrentPage();return null===n?{}:r(n,t)}(e,t);if(a.size>0)for(let[e,t]of a)n[e]||(n[e]={nodesUsed:{}},n[e].name=t.name,n[e].description=t.description,n[e].resolvedType=t.resolvedType,n[e].priority="LOW");return function(e){let t="";for(let[a,n]of Object.entries(e)){if(t+=`${a} has name "${n.name}", resolvedType "${n.resolvedType}"`,n.description&&(t+=`, description "${n.description.slice(0,100)}"`),n.priority?t+=`, priority "${n.priority}"`:t+=', priority "NORMAL"',Object.keys(n.nodesUsed).length>0)for(let[e,{nodeName:a,fields:l}]of(t+=", and is used in ",Object.entries(n.nodesUsed)))t+=`node ${a} with fields ${l.join(", ")}`;t+="\n"}return t}(n)}async function c(e,t,a=.5){let l=[];for(let[t,a]of e)a.description?l.push(`${a.name}: ${a.description}`):l.push(a.name);let r=(await n.Ay.openai.computeEmbeddings({model:"text-embedding-3-small",input:[t,...l],use_cache:!0})).data.map(e=>e.embedding),i=r[0],o=new Map,c=Array.from(e);for(let e=1;e<r.length;e++)if(function(e,t){return e.reduce((e,a,n)=>e+a*t[n],0)/(Math.sqrt(e.reduce((e,t)=>e+t*t,0))*Math.sqrt(t.reduce((e,t)=>e+t*t,0)))}(i,r[e])>a){let[t,a]=c[e-1];o.set(t,a)}return o}},511787:(e,t,a)=>{a.d(t,{f:()=>v});var n=a(411855),l=a(153234),r=a(572206),i=a(268537),o=a(574176),c=a(318812),d=a(720488),u=a(704762),s=a(820396),m=a(675357),p=a(50275),b=a(501191);function v({resolvedTypes:e,recordingKey:t}){let{showing:a,toggle:i,hide:s}=(0,c.B)("expression-builder-create-variable"),m=n.useRef(null),v=l.rf(l.Pt(t,"createVariableDropdown"),"click",n.useCallback(()=>{1===e.length?E(e[0]):i()},[e,i])),[g,_]=n.useState(!1),h=n.useRef(null),E=e=>{var t;let a=null==(t=m.current)?void 0:t.getBoundingClientRect();a&&(h.current={initialPosition:new r.Mi(a.left,a.top),resolvedType:e},_(!0))},y=()=>{_(!1)};return n.createElement(n.Fragment,null,n.createElement("button",{ref:m,className:p.ZS,onClick:v},n.createElement(o.B,{svg:b.A})),g&&(g&&h.current?n.createElement(u.IU,{initialPosition:h.current.initialPosition,resolvedType:h.current.resolvedType,onCreateVariable:y,onClose:y}):null),a&&m.current&&n.createElement(d.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:m.current.getBoundingClientRect()},e.map(e=>n.createElement(f,{key:e,resolvedType:e,onClose:s,showCreationModal:E,recordingKey:t}))))}function f({resolvedType:e,onClose:t,showCreationModal:a,recordingKey:r}){let o=(0,m.F)(e),c=l.rf(l.Pt(r,"createVariableOption",o.name),"click",n.useCallback(()=>{a(e),t()},[t,e,a]));return n.createElement(i.W.Option,{className:p.Fs,onClick:c},n.createElement(s.i,{type:e,showTooltip:!1}),o.name)}},704762:(e,t,a)=>{a.d(t,{Ty:()=>z,iG:()=>B,IU:()=>K,C_:()=>j});var n=a(411855),l=a(188507),r=a(421757),i=a(89865),o=a.n(i),c=a(935283),d=a(91408),u=a(320063),s=a(572174),m=a(153234),p=a(776621),b=a(286640),v=a(946689),f=a(659838),g=a(939863),_=a(175290),h=a(632430),E=a(877953),y=a(852800),C=a(662531),I=a(869156),T=a(318812),S=a(173454),V=a(498606),A=a(7959),w=a(538697),x=a(761334),N=a(746806),U=a(894742),M=a(282263),O=a(564092),k=a(15270),P=a(656963),R=a(860168);let $="variable_create_modal--input--d-tVA";var L=a(424148);let W=2*(0,d.jz)(R.dGl),B=304;function K({initialPosition:e,initialValue:t,resolvedType:a,onCreateVariable:l,onClose:r}){(0,x.NF)({resolvedType:a});let{onCreateVariableSubmit:i}=j({onCreateVariable:l,onClose:r});return n.createElement(F,{initialPosition:e,initialValue:t,resolvedType:a,onCreateVariableSubmit:i,onClose:r,recordingKey:"createVariableModal"})}function j({onCreateVariable:e,onClose:t}){return{onCreateVariableSubmit:function({varSetID:a,varName:n,varValue:l}){if(!y.CWU.isValidVariableName(n,a)){(0,p.x1)("variables","Attempted to submit variable name that is invalid",{varName:n,_varSetID:a});return}C.l7.user("create-variable",()=>{let t=a??y.CWU.createVariableSet((0,g.t)("variables.variable_collection"),y.G6k.AUTOMATIC_FIRST_COLLECTION),r=y.CWU.createVariable(n,t,l,y.HS4.VARIABLE_PICKER),i=y.CWU.getLocalVariableInfo(r);(0,c.B1)(i,`variable with id ${r} not found`),e((0,S.kz)(i))}),t()}}}function F({initialPosition:e,initialValue:t,resolvedType:a,recordingKey:l,onCreateVariableSubmit:r,onClose:i}){return n.createElement(N.vx,{title:n.createElement("div",{className:"variable_create_modal--staticTitle--HS1IC"},n.createElement(g.Tx,{id:"variables.create_modal.title"})),initialPosition:e,initialWidth:B,onClose:i},n.createElement(z,{resolvedType:a,initialValue:t,recordingKey:m.Pt(l,"createVariableForm"),onSubmit:r}))}function z({resolvedType:e,initialValue:t,recordingKey:a,onSubmit:i}){let o=(0,l.wA)(),c=(0,I.yp)(),p=(0,n.useRef)(null),[C,T]=(0,b.Vc)("last-used-variable-set-bottoms-up",c.length>0?c[0].node_id:null),S=(0,n.useMemo)(()=>{let e=c.find(e=>e.node_id===C);return!e&&c.length>0?c[0]:e},[c,C]),w=(0,I.rW)((null==S?void 0:S.node_id)??null),[x,N]=(0,n.useState)((0,k.Wc)(w,e)),B=(0,n.useRef)(null);(0,u.h)(()=>{var e;null==(e=B.current)||e.select()});let[K,j]=(0,n.useState)(()=>t??(0,k.WI)(e)),F=function(e){let t=(0,I.BQ)(e.type===y.Z_n.ALIAS?e.value:void 0);return(0,s.Vq)(t)&&"MIXED"!==t?t:null}(K),z=(0,E.C)("fpl_variables_button_migration"),Z=(0,n.useMemo)(()=>y.CWU.isValidVariableName(x,(null==S?void 0:S.node_id)??null),[x,null==S?void 0:S.node_id]);async function X(t){if(t){let a=await o((0,h.Oe)(t));j((0,O.y$)(e,a))}else K.type===y.Z_n.ALIAS&&j((0,k.WI)(e))}(0,n.useEffect)(()=>{let e=p.current;if(!e)return;let t=e=>e.preventDefault();return e.addEventListener("contextmenu",t),()=>{e.removeEventListener("contextmenu",t)}},[p]);let G=m.of(a,"submit",()=>{i({varName:x,varValue:K,varSetID:(null==S?void 0:S.node_id)??null})});function Y({label:e,input:t}){return n.createElement(_.Y,{spacing:0,horizontalAlignItems:"space-between",height:"hug-contents",padding:{horizontal:W}},n.createElement(A.JU,null,e),t)}return n.createElement("form",{onSubmit:G,autoComplete:"no"},n.createElement(_.Y,{direction:"vertical",spacing:0,height:"hug-contents",ref:p},n.createElement(_.Y,{direction:"vertical",spacing:`${(0,d.jz)(R.dGl)}px`,padding:{top:W},height:"hug-contents"},c.length>0&&!!S&&Y({label:n.createElement(g.Tx,{id:"variables.create_modal.collection_label"}),input:n.createElement("div",{className:$},n.createElement(D,{selectedVariableSetID:S.node_id,variableSets:c,onChange:T}))}),Y({label:n.createElement(g.Tx,{id:"variables.create_modal.name_label"}),input:n.createElement(f.L,{className:"variable_create_modal--textInput--234SQ raw_components--textInput--t9D8g raw_components--base--T7G0z raw_components--input--JB4Ix raw_components--singleRowHeight--dKM4t raw_components--border--SKh2u",name:"variableName",value:x,onChange:e=>{N(e.target.value)},ref:B,recordingKey:m.Pt(a,"variableNameInput"),delay:50,"data-1p-ignore":!0,autoFocus:!0})}),Y({label:n.createElement(g.Tx,{id:"variables.create_modal.value_label"}),input:n.createElement("div",{className:$},n.createElement(M.Cr,{resolvedType:e,variableValue:K,onVariableValueChange:e=>j(e),onVariableSelected:X},n.createElement(P.g,{variableValue:K,contextType:U.$.FORM,onChange:e=>j(e),recordingKey:m.Pt(a,"variableValueInput")}),F&&n.createElement(A.K0,{svg:L.A,type:"button","data-tooltip-type":V.Ib.TEXT,"data-tooltip":(0,g.t)("variables.authoring_modal.table.detach_alias"),onClick:()=>j(F),recordingKey:m.Pt(a,"detachVariableButton")})))}))),n.createElement(_.Y,{horizontalAlignItems:"end",verticalAlignItems:"center",padding:16},z?n.createElement(r.$n,{type:"submit",disabled:!Z,recordingKey:m.Pt(a,"createButton"),"data-tooltip-type":Z?void 0:V.Ib.TEXT,"data-tooltip":(0,g.t)("variables.create_modal.invalid_variable_name")},n.createElement(g.Tx,{id:"variables.create_modal.create_button"})):n.createElement(v.$$,{style:{justifySelf:"right"},tabIndex:0,type:"submit",disabled:!Z,recordingKey:m.Pt(a,"createButton"),"data-tooltip-type":Z?void 0:V.Ib.TEXT,"data-tooltip":(0,g.t)("variables.create_modal.invalid_variable_name")},n.createElement("span",null,n.createElement(g.Tx,{id:"variables.create_modal.create_button"})))))}function D({selectedVariableSetID:e,variableSets:t,onChange:a}){let r=(0,l.wA)(),i=(0,T.U)(),c=(0,n.useMemo)(()=>o()(t,e=>e.node_id),[t]);return n.createElement(w.l6,{id:"variable-create-modal-variable-set-select",property:c[e],formatter:{format:e=>(null==e?void 0:e.name)??""},dispatch:r,chevronClassName:"variable_create_modal--variableSetSelectChevron--larcU",inputClassName:"variable_create_modal--variableSetSelectInput--YUE3H",dropdownShown:i,onChange:e=>a(e.node_id)},t.map(function(e){return n.createElement(w.c$,{key:e.node_id,value:e})}))}}}]);

//# debugId=5cf31a09-18a7-5881-97ad-68b7caa9fba2

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/fd4936997b611d6f3234a091b1d9c2c08c5cdfc1/9246-be462c94a1b9a0b6.min.js.map